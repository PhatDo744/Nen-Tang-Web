<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý sinh viên - Bootstrap</title>

    <link href="bootstrap.min.css" rel="stylesheet">
    <style>

        body {
            background-color: #f4f4f4;
        }
        
        .navbar-custom {
            background-color: #333 !important;
            padding: 15px;
        }
        
        .navbar-custom h1 {
            color: white;
            margin: 0;
            font-size: 24px;
        }
        
        .section-header {
            background-color: darkslategray;
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin: 20px 0;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .form-container, .table-container {
            background: #fff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .form-control {
            border: 2px solid gainsboro;
            border-radius: 5px;
            max-width: 406px;
        }
        
        .form-control:focus {
            border-color: #435d7d;
            box-shadow: none;
        }
        
        .form-check-input {
            transform: scale(1.2);
            accent-color: #435d7d;
        }
        
        .form-check-input:checked {
            background-color: cadetblue;
            border-color: cadetblue;
        }
        
        .btn-custom {
            background-color: cadetblue;
            border-color: cadetblue;
            color: white;
            padding: 12px 25px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 16px;
        }
        
        .btn-custom:hover {
            background-color: #435d7d;
            border-color: #435d7d;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .table thead th {
            background-color: darkcyan;
            color: white;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 15px;
        }
        
        .table tbody tr {
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }
        
        .table tbody tr:hover {
            background-color: #f1f1f1;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .table td {
            padding: 15px;
        }
        
        .action-link {
            color: darkslategray;
            text-decoration: none;
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 3px;
            transition: all 0.3s ease;
        }
        
        .action-link:hover {
            background-color: darkslategray;
            color: white;
            text-decoration: none;
        }
        
        label {
            color: darkslategray;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .form-check-label {
            margin-left: 5px;
        }
        
        textarea.form-control {
            height: 100px;
            resize: vertical;
            max-width: 406px;
        }
        #bangSinhVien tbody tr:last-child td {
            border-bottom: 1px solid #dee2e6;
        }
        @media (max-width: 768px) {
            .navbar-custom h1 {
                font-size: 20px;
            }
            
            .form-container, .table-container {
                padding: 15px;
            }
            
            .form-control, textarea.form-control {
                max-width: 100%;
            }
            
            .btn-custom {
                width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            .navbar-custom {
                padding: 10px;
            }
            
            .navbar-custom h1 {
                font-size: 18px;
            }
            
            .section-header {
                font-size: 18px;
                padding: 10px;
                margin: 15px 0;
            }
            
            .form-container, .table-container {
                padding: 10px;
            }
            
            .table {
                font-size: 12px;
            }
            
            .table th, .table td {
                padding: 8px 5px;
            }
            
            .action-link {
                padding: 3px 6px;
                font-size: 12px;
            }
            
            .btn-custom {
                padding: 10px 20px;
                font-size: 14px;
            }
            
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-custom">
        <div class="container-fluid">
            <h1>Quản lý sinh viên</h1>
        </div>
    </nav>
    <div id="thongBao" class="alert alert-success alert-dismissible fade show d-none" role="alert">
            <span id="noiDungThongBao"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    <div class="container-fluid p-3">
        <div class="row g-3">
            <div class="col-lg-4 col-md-12">
                <div class="form-container" id="formThemContainer">
                    <h2 class="section-header">Form thêm sinh viên</h2>
                    <form action="" method="post" id="formThem">
                        <div class="mb-3">
                            <label for="student_class" class="form-label">Mã sinh viên:</label>
                            <input type="text" class="form-control" id="student_class" name="student_class" required>
                        </div>
                        
                        <div class="mb-3">
                            <label for="name" class="form-label">Họ và tên:</label>
                            <input type="text" class="form-control" id="name" name="name" required>
                        </div>
                        
                        <div class="mb-3">
                            <label for="email" class="form-label">Email:</label>
                            <input type="email" class="form-control" id="email" name="email" required>
                        </div>
                        
                        <div class="mb-3">
                            <label for="date_of_birth" class="form-label">Ngày sinh:</label>
                            <input type="date" class="form-control" id="date_of_birth" name="date_of_birth" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Giới tính:</label>
                            <div class="d-flex flex-wrap gap-3 mt-2">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="gender" id="gender_male" value="male">
                                    <label class="form-check-label" for="gender_male">Nam</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="gender" id="gender_female" value="female">
                                    <label class="form-check-label" for="gender_female">Nữ</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="gender" id="gender_other" value="other">
                                    <label class="form-check-label" for="gender_other">Khác</label>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="note" class="form-label">Ghi chú:</label>
                            <textarea class="form-control" id="note" name="note" rows="4"></textarea>
                        </div>
                        <button type="submit" class="btn btn-custom mt-3" id="btnThem">Thêm sinh viên</button>
                    </form>
                </div>
                <div class="form-container d-none" id="formSuaContainer">
                    <h2 class="section-header">Form sửa sinh viên</h2>
                    <form action="" method="post" id="formSua">
                        <input type="hidden" id="rowIndex" name="rowIndex" value="">
                        <div class="mb-3">
                            <label for="student_class" class="form-label">Mã sinh viên:</label>
                            <input type="text" class="form-control" id="edit_student_class" name="student_class" required>
                        </div>
                        
                        <div class="mb-3">
                            <label for="name" class="form-label">Họ và tên:</label>
                            <input type="text" class="form-control" id="edit_name" name="name" required>
                        </div>
                        
                        <div class="mb-3">
                            <label for="email" class="form-label">Email:</label>
                            <input type="email" class="form-control" id="edit_email" name="email" required>
                        </div>
                        
                        <div class="mb-3">
                            <label for="date_of_birth" class="form-label">Ngày sinh:</label>
                            <input type="date" class="form-control" id="edit_date_of_birth" name="date_of_birth" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Giới tính:</label>
                            <div class="d-flex flex-wrap gap-3 mt-2">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="edit_gender" id="edit_gender_male" value="male">
                                    <label class="form-check-label" for="edit_gender_male">Nam</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="edit_gender" id="edit_gender_female" value="female">
                                    <label class="form-check-label" for="edit_gender_female">Nữ</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="edit_gender" id="edit_gender_other" value="other">
                                    <label class="form-check-label" for="edit_gender_other">Khác</label>
                                </div>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="note" class="form-label">Ghi chú:</label>
                            <textarea class="form-control" id="edit_note" name="note" rows="4"></textarea>
                        </div>
                        <button type="submit" class="btn btn-custom mt-3" id="btnCapNhat">Cập nhật</button>
                    </form>
                </div>
            </div>  
            <div class="col-lg-8 col-md-12">
                <div class="table-container">
                    <h2 class="section-header">Bảng hiển thị danh sách sinh viên</h2>
                    <div class="table-responsive">
                        <table class="table table-hover" id="bangSinhVien">
                            <thead>
                                <tr>
                                    <th style="border-top-left-radius: 10px;" >STT</th>
                                    <th>Mã sinh viên</th>
                                    <th>Họ tên</th>
                                    <th>Email</th>
                                    <th>Giới tính</th>
                                    <th>Ngày sinh</th>
                                    <th colspan="2" style="border-top-right-radius: 10px;">Hành động</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1</td>
                                    <td>SV001</td>
                                    <td>Nguyễn Văn A</td>
                                    <td>vana@gmail.com</td>
                                    <td>Nam</td>
                                    <td>2000-01-01</td>
                                    <td><a href="#" class="action-link" onclick="suaDong(this)">Sửa</a></td>
                                    <td><a href="#" class="action-link" onclick="xoaDong(this)">Xóa</a></td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td>SV002</td>
                                    <td>Trần Thị B</td>
                                    <td>tranb@gmail.com</td>
                                    <td>Nữ</td>
                                    <td>2000-02-02</td>
                                    <td><a href="#" class="action-link" onclick="suaDong(this)">Sửa</a></td>
                                    <td><a href="#" class="action-link" onclick="xoaDong(this)">Xóa</a></td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td>SV003</td>
                                    <td>Nguyễn Văn C</td>
                                    <td>vanc@gmail.com</td>
                                    <td>Nam</td>
                                    <td>2000-01-01</td>
                                    <td><a href="#" class="action-link" onclick="suaDong(this)">Sửa</a></td>
                                    <td><a href="#" class="action-link" onclick="xoaDong(this)">Xóa</a></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="bootstrap.bundle.min.js"></script>
    <script>
        //them
        let selectedRow = null;
        document.getElementById("btnThem").addEventListener("click", function (e) {
            e.preventDefault();

            let maSV = document.getElementById("student_class").value;
            let hoTen = document.getElementById("name").value;
            let email = document.getElementById("email").value;
            let ngaySinh = document.getElementById("date_of_birth").value;

            let gioiTinh =  "";
            let genderInputs = document.getElementsByName("gender");
            for (let i = 0; i < genderInputs.length; i++) {
                if (genderInputs[i].checked) {
                    if (genderInputs[i].value === "male") {
                        gioiTinh = "Nam";
                    } else if (genderInputs[i].value === "female") {
                        gioiTinh = "Nữ";
                    }
                    else {
                        gioiTinh = "Khác";
                    }
                    break;
                }
            }
            if (!validateForm(maSV, hoTen, email, ngaySinh, gioiTinh)) {
                return false;
            }

            let table = document.getElementById("bangSinhVien").getElementsByTagName("tbody")[0];
            let currentRowCount = table.rows.length;
            let stt = currentRowCount + 1;

            let newRow = table.insertRow();
            newRow.insertCell(0).innerText = stt;
            newRow.insertCell(1).innerText = maSV;
            newRow.insertCell(2).innerText = hoTen;
            newRow.insertCell(3).innerText = email;
            newRow.insertCell(4).innerText = gioiTinh;
            newRow.insertCell(5).innerText = ngaySinh;
            newRow.insertCell(6).innerHTML = '<a href="#" class="action-link" onclick="suaDong(this)">Sửa</a>';
            newRow.insertCell(7).innerHTML = '<a href="#" class="action-link" onclick="xoaDong(this)">Xóa</a>';

            document.getElementById("#formThem").reset();
            showThongBao("Đã thêm sinh viên thành công!", "success");
        });
        //thongbao
        function showThongBao(message, type) {
            let thongBaoDiv = document.getElementById("thongBao");
            let noiDungSpan = document.getElementById("noiDungThongBao");
            
            // Xóa class cũ và thêm class mới
            thongBaoDiv.className = `alert alert-${type} alert-dismissible fade show`;
            noiDungSpan.innerText = message;

            window.scrollTo(0, 0); // Cuộn lên đầu trang
            
            // Tự động ẩn sau 3 giây
            setTimeout(() => {
                thongBaoDiv.classList.add("d-none");
            }, 3000);
        }

        function xoaDong(element) {
            if(confirm("Bạn có chắc chắn muốn xóa dòng này?")) {
                let row = element.closest("tr");
                row.remove();

                let table = document.getElementById("bangSinhVien").getElementsByTagName("tbody")[0];
                let rows = table.rows;
                for (let i = 0; i < rows.length; i++) {
                    rows[i].cells[0].innerText = i + 1; 
                }
            }
            showThongBao("Đã xóa sinh viên thành công!", "success");
        }
        //sua
        function suaDong(element) {
            selectedRow = element.closest("tr");

            document.getElementById("formThemContainer").classList.add("d-none");
            document.getElementById("formSuaContainer").classList.remove("d-none");

            document.getElementById("edit_student_class").value = selectedRow.cells[1].innerText;
            document.getElementById("edit_name").value = selectedRow.cells[2].innerText;
            document.getElementById("edit_email").value = selectedRow.cells[3].innerText;
            document.getElementById("edit_date_of_birth").value = selectedRow.cells[5].innerText;

            let gioiTinh = selectedRow.cells[4].innerText;
            if (gioiTinh === "Nam") {
                document.getElementById("edit_gender_male").checked = true;
            } else if (gioiTinh === "Nữ") {
                document.getElementById("edit_gender_female").checked = true;
            } else {
                document.getElementById("edit_gender_other").checked = true;
            }

            window.scrollTo(0, 0); // Cuộn lên đầu trang
        }

        
        document.getElementById("btnCapNhat").addEventListener("click", function (e) {
            e.preventDefault();

            let maSV = document.getElementById("edit_student_class").value;
            let hoTen = document.getElementById("edit_name").value;
            let email = document.getElementById("edit_email").value;
            let ngaySinh = document.getElementById("edit_date_of_birth").value;
            let gioiTinh = "";
            let genderInputs = document.getElementsByName("edit_gender");
            for (let i = 0; i < genderInputs.length; i++) {
                if (genderInputs[i].checked) {
                    if (genderInputs[i].value === "male") {
                        gioiTinh = "Nam";
                    } else if (genderInputs[i].value === "female") {
                        gioiTinh = "Nữ";
                    }
                    else {
                        gioiTinh = "Khác";
                    }
                    break;
                }
            }
            
            if (!validateForm(maSV, hoTen, email, ngaySinh, gioiTinh)) {
                window.scrollTo(0,0);
                return false;
            }

            selectedRow.cells[1].innerText = maSV;
            selectedRow.cells[2].innerText = hoTen;
            selectedRow.cells[3].innerText = email;
            selectedRow.cells[4].innerText = gioiTinh;
            selectedRow.cells[5].innerText = ngaySinh;

            // Hiển thị thông báo
            showThongBao("Đã cập nhật thông tin sinh viên thành công!", "success");

            // Đóng form sửa
            document.getElementById("formSuaContainer").classList.add("d-none");
            document.getElementById("formThemContainer").classList.remove("d-none");

            // Reset biến chọn dòng
            selectedRow = null;
        })

        function validateForm(maSV, hoTen, email, ngaySinh, gioiTinh) {
            if (!maSV.trim() || !hoTen.trim() || !email.trim() || !ngaySinh.trim() || !gioiTinh.trim()) {
                showThongBao("Vui lòng điền đầy đủ thông tin!", "warning");
                return false;
            }

            let emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email.trim())) {
                showThongBao("Email không đúng định dạng!", "warning");
                return false;
            }

            let maSVRegex = /^SV\d+$/;
            if (!maSVRegex.test(maSV.trim())) {
                showThongBao("Mã sinh viên phải có định dạng SV + số (VD: SV001)", "warning");
                return false;
            }

            let hoTenRegex = /^[a-zA-Zàáảãạâầấẩẫậăằắẳẵặèéẻẽẹêềếểễệìíỉĩịòóỏõọôồốổỗộơờớởỡợùúủũụưừứửữựỳýỷỹỵđ\s]+$/;
            if (!hoTenRegex.test(hoTen.trim())) {
                showThongBao("Họ tên không được chứa ký tự đặc biệt hoặc chữ số", "warning");
                return false;
            }
            let table = document.getElementById("bangSinhVien").getElementsByTagName("tbody")[0];
            let rows = table.rows;
            for (let i = 0; i < rows.length; i++) {
                if (rows[i] !== selectedRow && rows[i].cells[1].innerText === maSV) {
                    showThongBao("Mã sinh viên đã tồn tại trong danh sách!", "warning");
                    return false;
                }
            }
            return true;
        }
    </script>
</body>
</html>